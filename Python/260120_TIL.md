## [TIL] 파이썬을 활용한 공공데이터 API 처리 및 데이터 최적화

### 1. API 데이터 호출 및 환경 설정

* **핵심 목적**: 외부 API(에어코리아 대기오염 정보)를 호출하고, 보안이 필요한 인증키를 안전하게 관리합니다.
* **주요 라이브러리**:
* `requests`: HTTP 통신을 통해 서버에 데이터를 요청합니다.
* `python-dotenv`: `.env` 파일에 저장된 `serviceKey`를 환경 변수로 불러와 코드 내 보안을 유지합니다.


* **요청 파라미터**: `sidoName`(측정 지역), `returnType`(데이터 포맷), `ver`(API 버전) 등을 설정하여 원하는 데이터를 필터링해 가져옵니다.

### 2. 데이터 정제 및 예외 처리 (Data Cleaning)

실시간 데이터에는 장비 고장이나 통신 장애로 인한 '오염된 데이터'가 포함될 수 있어 정제 과정이 필수적입니다.

* **Flag 처리**: `pm25Flag` 변수에 값이 있는 경우(장비 점검, 통신 장애 등) 해당 데이터를 신뢰할 수 없으므로 `continue`를 통해 건너뜁니다.
* **결측치 처리**: 수치가 `'-'`와 같이 문자열로 들어오는 경우, 이를 숫자형(`int`)으로 변환하면 에러가 발생하므로 사전에 조건문으로 예외 처리를 해야 합니다.
* **최솟값 찾기**: `float('inf')`(무한대)를 초기값으로 설정하여 리스트를 순회하며 가장 낮은 농도를 가진 측정소를 찾습니다.

### 3. 데이터 구조 최적화: List vs Dictionary

데이터를 단순히 나열된 리스트에서 키-값 쌍인 딕셔너리로 변환하여 검색 성능을 극대화합니다.

* **리스트 방식 (순차 탐색)**: 원하는 측정소를 찾기 위해 전체 데이터를 처음부터 끝까지 대조해야 하므로 데이터가 많을수록 속도가 저하됩니다 ().
* **딕셔너리 방식 (해시 탐색)**: `stationName`을 `Key`로 설정하여 데이터를 재구성하면, 검색 시 단 한 번에 해당 데이터에 접근할 수 있습니다 ().

### 4. 실습 코드 요약

#### 딕셔너리 변환 및 안전한 검색

```python
import pprint

# 1. 데이터를 이름 기반의 딕셔너리로 재구성
dust_info_dic = {}
for info in dust_info:
    station_name = info['stationName']
    dust_info_dic[station_name] = info

# 2. 특정 측정소 데이터에 즉시 접근
target = '강남구'
if target in dust_info_dic:
    pprint.pprint(dust_info_dic[target])

```

### 5. 학습 포인트 (Troubleshooting)

* **IndentationError(들여쓰기 오류)**: 파이썬은 `if`, `for` 등 콜론(`:`) 뒤에 오는 실행문을 반드시 들여쓰기로 구분해야 합니다. 실행할 코드가 없을 때는 `pass` 키워드를 사용해야 에러가 발생하지 않습니다.
* **변수 초기화 위치**: 누적 데이터를 담을 딕셔너리나 리스트는 루프(`for`) 밖에서 초기화해야 데이터가 덮어씌워지지 않고 유지됩니다.
* **데이터 타입 변환**: API로 받은 값은 기본적으로 문자열이므로, 수치 비교를 위해서는 반드시 `int()`나 `float()`로 형변환을 거쳐야 합니다.

---

**오늘의 배움:** 단순히 데이터를 가져오는 것에 그치지 않고, **실패 가능성(예외 처리)**을 고려하고 **사용자가 쓰기 편한 구조(딕셔너리)**로 데이터를 가공하는 과정이 실무 코딩의 핵심임을 배웠습니다.
